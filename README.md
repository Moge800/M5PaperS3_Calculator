# M5PaperS3 電卓アプリ

このプロジェクトは、M5PaperS3デバイス用の電卓アプリケーションです。UIFlow2.0環境またはMicroPythonとして動作します。

## ライセンス

このプロジェクトは Apache License 2.0 の下で提供されています。詳細は `license` ファイルを参照してください。

## 機能

- 基本的な四則演算（加算、減算、乗算、除算）
- 平方根計算
- 符号反転
- 小数点対応
- バックスペース機能
- クリア機能
- エラーハンドリング

## 使い方

### UIFlow2.0で実行する場合

1. UIFlow2.0を起動します
2. M5PaperS3デバイスを接続します
3. main.pyとboot.pyファイルをUIFlow2.0にアップロードします
4. uiflow.jsonを設定ファイルとして使用します
5. プログラムをM5PaperS3デバイスに転送します
6. デバイス上で電卓アプリを使用できます

### 直接MicroPythonとして実行する場合

1. M5PaperS3デバイスをUSB接続します
2. boot.pyとmain.pyをデバイスのルートディレクトリにコピーします
3. デバイスを再起動します
4. 自動的に電卓アプリが起動します

## ボタンレイアウト

```text
| 7 | 8 | 9 | / |
| 4 | 5 | 6 | * |
| 1 | 2 | 3 | - |
| 0 | . | = | + |
| C |+/-| < |rt |
```

## ボタンの機能

- **数字ボタン (0-9)**: 数値入力
- **演算子 (+, -, *, /)**: 演算の選択
- **=**: 計算実行
- **.**: 小数点の入力
- **C**: すべてクリア
- **+/-**: 符号反転（正/負の切り替え）
- **<**: バックスペース（1文字削除）
- **rt**: 平方根計算

## 動作環境

- UIFlow2.0環境または直接MicroPythonとして実行可能
- M5PaperS3デバイス専用です
- 表示できる桁数には制限があります。大きすぎる数値は指数表記になります

## カスタマイズ

コード内の以下の変数を変更することで、見た目や動作をカスタマイズできます：

- `button_width`、`button_height`: ボタンのサイズ
- `button_gap`: ボタン間の隙間
- `start_x`、`start_y`: キーパッドの開始位置
- 各ボタンの背景色（`bg_color`）

## トラブルシューティング

デバイス上でうまく動作しない場合は、以下を確認してください：

1. USBシリアルログで詳細なエラー情報を確認する
2. エラーハンドラが機能しているか確認する
3. UIFlow2.0の最新バージョンを使用しているか確認する
4. デバイスのファームウェアが最新かどうか確認する

## その他の注意事項

- コードはメモリ最適化のためにガベージコレクション（GC）を積極的に活用しています
- タッチ検出には少しの遅延があります（安定性向上のため）
- エラーハンドリングが組み込まれており、問題が発生した場合は自動的に回復を試みます
- 最新のUIFlow MicroPythonドキュメントに基づいて作成されていますが、ドキュメントと実際の実装に差異がある場合があります。その場合は、最新の環境に合わせて調整してください
